"use strict";Object.defineProperty(exports,"__esModule",{value:true});require("babel-polyfill");var _server=require("../../server");var _logger=require("../../common/logger");var _logger2=_interopRequireDefault(_logger);var _didWebStart=require("./didWebStart");var _didWebStart2=_interopRequireDefault(_didWebStart);var _snapper=require("../../snapshots/snapper");var _snapper2=_interopRequireDefault(_snapper);var _withComponent=require("./withComponent");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var mobileHooks=function mobileHooks(){var server=void 0;var setup=function setup(){return regeneratorRuntime.async(function setup$(_context){while(1){switch(_context.prev=_context.next){case 0:server=new _server.FructoseServer(7811);_context.next=3;return regeneratorRuntime.awrap(server.start().then(function(){return _logger2.default.verbose("setup","fructose server started on port : 7811");}));case 3:case"end":return _context.stop();}}},null,undefined);};var cleanup=function cleanup(){return regeneratorRuntime.async(function cleanup$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return regeneratorRuntime.awrap((0,_withComponent.disconnectClient)());case 2:server.close();case 3:case"end":return _context2.stop();}}},null,undefined);};var takeScreenShot=function takeScreenShot(platform,screenshotPath){var snapper;return regeneratorRuntime.async(function takeScreenShot$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:snapper=new _snapper2.default(platform);_context3.next=3;return regeneratorRuntime.awrap(snapper.snap(screenshotPath));case 3:case"end":return _context3.stop();}}},null,undefined);};return{setup:setup,cleanup:cleanup,takeScreenShot:takeScreenShot};};var webHooks=function webHooks(){var server=void 0;var setup=function setup(port,timeout){var appStarted;return regeneratorRuntime.async(function setup$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return regeneratorRuntime.awrap((0,_didWebStart2.default)(port,timeout));case 2:appStarted=_context4.sent;if(appStarted){_context4.next=5;break;}throw new Error("App did not start. Run 'fructose-web --build-dir path/to/dir' first");case 5:server=new _server.FructoseServer(7811);_context4.next=8;return regeneratorRuntime.awrap(server.start());case 8:case"end":return _context4.stop();}}},null,undefined);};var cleanup=function cleanup(){return regeneratorRuntime.async(function cleanup$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return regeneratorRuntime.awrap((0,_withComponent.disconnectClient)());case 2:server.close();case 3:case"end":return _context5.stop();}}},null,undefined);};return{setup:setup,cleanup:cleanup};};exports.default={web:webHooks(),mobile:mobileHooks()};